
START DH
ESTABLISH SECRET
ESTABLISH CONVO_ID (ENCRYPTED WITH SHARED SECRET)

MESSAGE = LENGTH | CONVO_ID | ENCRYPTED MESSAGE

IF MESSAGE WITH VALID CONVO_ID:
	DECRYPT MESSAGE WITH ASSOCIATED KEY
	SHOW MESSAGE

	
IF MESSAGE WITH INVALID CONVO_ID: 
	
	SEND REJECT

IF RECIEVE REJECT:
	START DH
	GOTO (LINE 2)
